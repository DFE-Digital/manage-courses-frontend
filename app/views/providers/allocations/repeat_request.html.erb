
<% page_title = "Do you want to request PE for this organisation?"%>
<%= content_for :page_title, page_title%>

<% content_for :before_content do %>
  <%= govuk_back_link_to(provider_recruitment_cycle_allocations_path) %>
<% end %>

<% legend = capture do %>
    <legend class="govuk-fieldset__legend govuk-fieldset__legend--xl">
        <h1 class="govuk-fieldset__heading">
            <span class="govuk-caption-xl"><%= @training_provider.provider_name %></span>
            <%= page_title %>
        </h1>
    </legend>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

  <%= form_with url: provider_recruitment_cycle_allocation_path(
                    @provider.provider_code,
                    @provider.recruitment_cycle_year,
                    params[:training_provider_code]
                  ) do |form| %>
      <fieldset class="govuk-fieldset">
        <%= legend %>
        <% field = "request_type" %>

        <%= render "shared/error_wrapper", error_keys: [field], data_qa: "allocation__#{field}" do %>
          <% {"Yes" => Allocation::RequestTypes::REPEAT, "No" => Allocation::RequestTypes::DECLINED}.each do |k,v| %>

          <div class="govuk-radios__item">
            <%= form.radio_button field,
                  v,
                  class: 'govuk-radios__input',
                  data: {
                    'aria-describedby': "#{field}-#{v}-help"
                  }
            %>
            <%= form.label "#{field}_#{v}", k, class: "govuk-label govuk-radios__label" %>
          </div>
        <% end %>
      </fieldset>

      <%= form.submit "Continue", class: "govuk-button", data: { qa: 'request_continue' } %>
      <% end %>
    <% end %>
  </div>
</div>
